<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>MozMill IDE</title>
	<meta name="generator" content="TextMate http://macromates.com/">
	<meta name="author" content="adam">
	<!-- Date: 2009-02-03 -->
	<link type="text/css" href="css/smoothness/jquery-ui-1.7.1.custom.css" rel="Stylesheet" />
  <link type="text/css" href="css/mozmill.css" rel="Stylesheet" />
	
  <script src="mozmill.js"></script>
  <script src="output.js"></script>
  <script src="dx.js"></script>
  <script src="rec.js"></script>
  <script src="menus.js"></script>

  <script src="jquery/jquery-1.3.2.min.js"></script>
  <script src="jquery/jquery-ui-1.7.1.custom.min.js"></script>
  <script src="ui.js"></script>
  <script src="editarea/edit_area/edit_area_loader.js"></script>

   <script src="jquery/fg.menu.js"></script>
   <link type="text/css" href="css/fg.menu.css" rel="Stylesheet" />

</head>
<body onunload="cleanUp();">
  <script src="shortcuts.js"></script>
  <script type="text/javascript">
  	var syncHeights = function(){
  	    $('#tabs')[0].style.height = window.innerHeight - 90 + "px";
        if ($('#editorInput')[0].style.height != window.innerHeight - 180 + "px"){
          if ( $('#tabs').tabs("option","selected") == 0 ){
            editAreaLoader.toggle("editorInput");
            $('#editorInput')[0].style.height = window.innerHeight - 180 + "px";
            editAreaLoader.toggle("editorInput");
          }
        }
        $('#editorInput')[0].style.height = window.innerHeight - 180 + "px";
        $('#resOut')[0].style.height = window.innerHeight - 170 + "px";
        $('#shellOutput')[0].style.height = window.innerHeight - 220 + "px";
  	}
  	
  	$(function() {
      $("#tabs").tabs();
      $('#tabs').bind('tabsshow', function(event, ui) {
         syncHeights();
         if ( $('#tabs').tabs("option","selected") == 0 ){
           editAreaLoader.toggle("editorInput");
           $('#editorInput')[0].style.height = window.innerHeight - 170 + "px";
           editAreaLoader.toggle("editorInput");
         }
      });

     $('#fileMenu').menu({ 
        content: $('#fileMenulist').html(), // grab content from this page
        showSpeed: 200 
     });

     $('#runMenu').menu({ 
        content: $('#runMenulist').html(), // grab content from this page
        showSpeed: 200 
     });
    
      $("#optionDialog").dialog({
  		  autoOpen: false,
        height: 250,
        width: 400,
        modal:true,
        resizable:false,
        overlay: { 
            opacity: 0.5, 
            background: "black" 
        },
        buttons: { 
         "Close": function() { 
             jQuery(this).dialog("close"); 
         } 
        }
      });
    
	});
  </script>

    <div style="position:absolute;width:98%;height:98%;overflow:hidden;">
      <div id="topBox">
      <a href="https://developer.mozilla.org/en/Mozmill" target=_blank style="float:right; margin-right: 8px; margin-bottom: 6px;">
         <image id="mozmillImage" src="img/wmIcon40.png" style="border:none;"/>
      </a>
      <div id="statusMessage" style="height:40px;" >
        <span><strong>Status:</strong></span>
        <span id="runningStatus">Ready...</span>
      </div>
      <div class="ui-helper-hidden" style="width:100%;text-align:right;font-size:12px;">
        <span style="cursor:pointer" onclick="showOptionDialog();">O<u>p</u>tions</span> |
        <a style="cursor:pointer" href="https://developer.mozilla.org/en/Mozmill" target=_blank>Help</a>
      </div>
     </div>
      <div id="tabs" style="position:relative;width:98%;height:90%">
      	<ul>
      		<li><a id="editorTab" href="#tabs-1">Editor</a></li>
      		<li><a id="outputTab" href="#tabs-2">Output</a></li>
      		<li><a id="eventsTab" href="#tabs-3">Inspector</a></li>
      		<li><a id="shellTab" href="#tabs-4">Shell</a></li>
      	</ul>
      	<div id="tabs-1">

          <span tabindex="0" class="menu" id="fileMenu"><u>F</u>ile</span>
          <div style="display:none;">
            <ul id="fileMenulist">
              <li class="menuitem"><a href="#" onclick="openFile();"><u>O</u>pen</a></li>
              <li class="menuitem"><a href="#" onclick="newFile();"><u>N</u>ew</a></li>
              <li class="menuitem"><a href="#" onclick="genBoiler();">New from Te<u>m</u>plate</a></li>
              <li class="menuitem"><a href="#" onclick="saveFile();"><u>S</u>ave</a></li>
              <li class="menuitem"><a href="#" onclick="saveAsFile();">Save <u>A</u>s</a></li>
              <li class="menuitem"><a href="#" onclick="closeFile();"><u>C</u>lose Current File</a></li>
              </ul>
            </div>
          <span tabindex="0" class="menu" id="runMenu"><u>T</u>est</span>
          <div style="display:none;">
            <ul id="runMenulist">
              <li class="menuitem"><a href="#" onclick="runEditor();">Run <u>E</u>ditor</a></li>
              <li class="menuitem"><a href="#" onclick="runFile();">Run <u>F</u>ile</a></li>
              <li class="menuitem"><a href="#" onclick="runDirectory();">Run <u>D</u>irectory</a></li>
              </ul>
            </div><span style="float:right;">
          <button id="runButton"  class="ui-state-default ui-corner-all" onclick="runEditor();">Run</button>
          <button id="recordToggle"  class="ui-state-default ui-corner-all" onclick="MozMillrec.toggle();"><u>R</u>ecord</button>
          </span>
          <textarea id="editorInput" value="" style="font-family:monospace;font-size:12px;width:100%"></textarea>
      	</div>
      	<div id="tabs-2">
          <div id="outOptions" >
            <span id="outToggles">
              Pass:<input id="outPass" label="Pass" type=checkbox checked onchange="updateOutput();"/>
              Fail:<input id="outFail" label="Fail" type=checkbox checked onchange="updateOutput();"/>
              Test:<input id="outTest" label="Test" type=checkbox checked onchange="updateOutput();"/>
            </span>
           <button id="outClear" style="float:right;" class="ui-state-default ui-corner-all" onclick="logicalClear();">C<u>l</u>ear</button></div>
          <p>
            <div id="resOut" style="overflow:auto;position:absolute;height:90%;width:98%"></div>
      	  </p>
      	</div>
      	<div id="tabs-3">
      	    <div id="dxOptions" style="float:right;">
      	        Double Click: <input id="inspectDouble" type="radio" name="inspectClickSelection" value="double" onclick="MozMilldx.changeClick();" checked>
                Single Click: <input id="inspectSingle" type="radio" name="inspectClickSelection" onclick="MozMilldx.changeClick();" value="single">
      	    </div>
          <br>
      	  <div id="dxContainer"><div id="elementStr">
            <strong>Element</strong>:
            <span ondblclick="copyToClipboard(this.textContent);" id="dxElement"></span></div>
            
            <span id="controllerStr"><strong>Controller</strong>:
            <span ondblclick="copyToClipboard(this.textContent);" id="dxController"></span></span>
            <br> <div class="ui-helper-hidden">
            <strong>Validation</strong>:
            <span ondblclick="copyToClipboard(this.textContent);" id="dxValidation"></span> </div>
          </div>
          <div id="dxButtons">
            <button id="dxToggle" class="ui-state-default ui-corner-all ui-priority-primary" onclick="MozMilldx.dxToggle();">Start</button>
            <button id="dxCopy" class="ui-state-default ui-corner-all ui-helper-hidden" onclick="copyInspector();">Send To Clipboard</button>
          </div>
      	</p>
      	</div>
      	<div id="tabs-4">
      		<p>
            <textarea id="shellInput">Type commands here...</textarea>
              <div id="shellOutput">
              </div>
      		</p>
      	</div>
      </div>

      <div id="inspectDialog" title="Inspector">  	
      </div>
      
      <div id="fileDialog" title="File Options">
      </div>
      
      <div id="testDialog" title="Test Options">

      </div>
      
      <div id="optionDialog" title="Options">
      	<p>
      	    <button class="ui-state-default ui-corner-all" onclick="align();">Ali<b>g</b>n Windows</button>
      	</p>
      </div>
      
      <div id="recordDialog" title="Recorder">
      </div>
      
    </div>
    
    <script language="Javascript" type="text/javascript">    
      //make the editor fill the space on mac
      // if (navigator.platform.indexOf('Mac') != -1){
      //       document.getElementById('editorInput').rows = 43;
      //     }
  		var eaInit = function(){
  		   window.openFn = utils.tempfile().path;
         editAreaLoader.openFile('editorInput', {text:'',title:getFileName(window.openFn),id:window.openFn});
         
         function alpha(e) {
           if (e.ctrlKey || e.metaKey){
             return false;
           }
           if ((e.charCode > 96) && (e.charCode < 123)){
             return true;
           }
           else if ((e.charCode > 64) && (e.charCode < 91)){
             return true;
           }
           else if ((e.charCode > 44) && (e.charCode < 58)){
             return true;
           }
           return false;
         };
         
         window.frames['frame_editorInput'].onkeypress = function(e){
           if (alpha(e)){
             var node = window.frames['frame_editorInput'].document.getElementById('tab_file_'+encodeURIComponent(window.openFn));
             node.getElementsByTagName("strong")[0].style.display = "inline";
           }
         }
         
         //fixing the editor or resize issue
          window.onresize = function(e){
            syncHeights();
          }
          syncHeights();
  		};
  		
  		var eaFileClosed = function(obj){
          var all = editAreaLoader.getAllFiles('editorInput');
          var count = 0;
          //open a new temp if the last window
          //gets closed, since there is no array
          //we have to loop the object properties
          for (x in all){
            count++;
          }
          if (count == 1){
            newFile();
          }
  		};
  		
  		var eaTabOn = function(obj){
  		  window.openFn = editAreaLoader.getCurrentFile('editorInput').id;
  		}
  	
      // initialisation
      editAreaLoader.init({
       id: "editorInput" // id of the textarea to transform    
       ,start_highlight: true  // if start with highlight
       ,allow_resize: false
       ,allow_toggle: true
       ,browsers: "all"
       ,language: "en"
       ,syntax: "js"
       ,is_multi_files: true
       ,EA_load_callback : "eaInit"
       ,EA_file_close_callback: "eaFileClosed"
       ,EA_file_switch_on_callback: "eaTabOn"
      });
    
  	</script>
  	<script src="shell.js"></script>
</body>
</html>
